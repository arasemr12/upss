<div class="w-full flex flex-col items-center gap-5">
    <div class="bg-gray-800 rounded-lg py-6 px-6 w-full flex flex-col items-center gap-10">
        <div class="flex flex-col items-center gap-1">
            <i class="fa-solid fa-user fa-2x bg-gray-700 py-4 px-4 rounded-full"></i>
            <span><%=myuser.email%></span>
            <h1 class="text-2xl font-bold">@<%=myuser.username%></h1>
        </div>
        <div class="flex flex-col items-center gap-1">
            <span class="text-4xl font-bold text-green-600 underline"><%=myuser.fallowers.length%></span>
            <span>Fallowers</span>
        </div>
    </div>
    <%let find = locals.user ? myuser.fallowers.find((e) => e.toString() == user._id.toString()) : null%>
    <%if(find){%>
        <a onclick="fallow('<%=myuser._id%>')" class="yellow-btn cursor-pointer w-full">UnFallow this user.</a>
    <%}else{%>
        <a onclick="fallow('<%=myuser._id%>')" class="green-btn cursor-pointer w-full">Fallow this user.</a>
    <%}%>
    <%if(locals.user && user.admin){%>
        <a class="red-btn w-full" href="/users/<%=myuser._id%>/delete">Delete this user.</a>
    <%}%>
    <div class="w-full flex flex-col items-center gap-5">
        <span class="text-xl font-bold uppercase">User posts</span>
        <div class="flex flex-col items-center w-full gap-12">
            <%myuser.posts.forEach((post) => {%>
                <div class="w-full border-2 border-slate-800 rounded-lg flex flex-col py-6 px-6 gap-4">
                    <div class="w-full flex flex-row items-center gap-x-4">
                        <!--<img src="https://cdn.discordapp.com/avatars/441221465019514881/54b62ae823642102bb7f9951b6540641.gif" class="rounded-full" width="32" alt="">-->
                        <i class="fa-solid fa-user fa-2x bg-gray-700 py-4 px-4 rounded-full"></i>
                        <a href="/users/<%=myuser._id%>" class="flex flex-col">
                            <span class="text-xs opacity-40"><%=myuser.email%></span>
                            <span class="text-xl font-bold">@<%=myuser.username%></span>
                        </a>
                    </div>
                    <div class="flex flex-col gap-5">
                        <span class="whitespace-pre-wrap"><%=post.content.slice(0,50)%></span>
                        <a class="link" href="/posts/<%=post._id%>">read more</a>
                        <div>
                            <i id="like-<%=post._id%>" class="fa-solid fa-heart cursor-pointer <%=locals.user ? post.likes.find(like => user._id.toString() == like.toString()) ? 'text-red-600' : '':''%>" onclick="like('<%=post._id%>')"></i>
                            <span id="likes-<%=post._id%>"><%=post.likes.length%></span>
                        </div>
                    </div>
                </div>
            <%})%>
        </div>
    </div>
</div>
<script>
    function fallow(id){
        fetch("/users/"+id+"/fallow").then(() => {
            window.location.reload();
        })
    }
</script>